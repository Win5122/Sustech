基于 SVM的脑电情绪识别 
 
一、课题背景  
 
情绪的科学定义受到过激烈的争论。这些分歧来源于看待问题的不同角度。从心理学
角度来看， Russell J.A （1980）等人将它定义为一系列具有唤起（即强烈程度） 、效价（积
极或消极）等特质的主观感觉（ ”consciously perceived feelings” ）。从生物学角度， Ekman
和Oster（1979）等人认为，情绪是一种帮助动物生存的，涉及到中枢神经系统、外周神
经系统和其它系统的一种基础生物学机制。每种具体的情绪对应该系统中的一个内在状态，
在该状态下，生物体可以更好地应对当前环境的外界刺激。这些状态的集合在进化中逐渐
分化和复杂化。这一定义的雏形早在 1872年就被达尔文提出。例如，恐惧起源于生物对
即将到来的负性刺激的预期；厌恶 起源于处于负性刺激下的惩罚机制；渴望和快乐起源于
正面刺激下的奖励机制等 。 
 
现在，科学界往往以二者结合的角度看待情绪。将情绪分为意识的部分，即 Russell 提
到的被主观感知的部分；以及功能的部分，即生物学的部分。也有人将功能部分进一步细
分为外部表现，即行为学特征，和生理唤起，即生理学特征。具体来说，外部表现包括情
绪状态下身体各部分的动作量化形式，包括面部表情、姿态表情和语调表情。生理唤醒则
可分为神经活动和外周活动。神经活动它涉及广泛的神经结构，如中枢神经系统的脑干、
中央灰质、丘脑、杏仁核、下丘脑、蓝斑、松果体、前额皮层，及外周神经系统和内、外
分泌腺等。外周活动包含心血管、呼吸、内 分泌、皮肤等多方面反应。  
 
脑电图（ Electroencephalogram, EEG ）是一种记录大脑电活动的无创性神经生理学技
术。通过在头皮表面放置电极阵列，能够捕获和记录大脑神经元的电位变化。这些电位变
化代表了大脑皮层神经元的同步放电活动，反映了大脑在不同认知、情感和行为状态下的
功能性变化。自上世纪初以来， EEG一直是神经科学研究和临床神经生理学诊断的重要工
具。其高时序分辨率和良好的时间解析度使其成为研究大脑动态活动的理想选择。此外，
EEG还具有出色的安全性和成本效益，使其在临床环境中得到广泛应用。随着先进的信号
处理技术和计算能力的发展， EEG已经成为研究大脑认知功能、情绪调节、神经疾病等领
域的重要工具。通过分析 EEG信号的频谱特征、事件相关电位（ ERPs）以及时空动态变化，
研究人员能够深入了解大脑在不同任务和状态下的信息处理机制。  
 
利用神经影像 信号来量化人的情绪状态对于人机交互系统以及精神病学诊断等应用领
域具有重要意义。先前的研究已经表明，脑电信号在情绪状态识别方面具有很高的潜力。
不同于其它生理学和行为学指标，脑电信号为情绪神经活动提供更直接准确的衡量，且不
能被主观掩饰和抑制。相比其它的神经影像学 方法如功能磁共振（ fMRI）和脑磁图（ MEG），
脑电具有便携性，经济性，高时间分辨率等优势。  
 
 微分熵（ Differential Entropy, DE ）是信息论中的一个重要概念，用于描述连续随机变
量的不确定性或信息量。与离散情况下的熵类似，微分熵衡量了一个随机变量的均匀性和
分散性，但它适用于连续概率分布。 形式上，对于一个连续随机变量 X，其概率密度函数
为p(x)，微分熵 H(X)定义如下：   
微分熵具有许多重要的应用，特别是在信号处理、统计建模和信息理论等领域。在信
号处理中，微分熵常用于衡量信号的复杂性和随机性，它可以帮助我们了解信号的特征以
及在压缩和编码等任务中的性能。它在模式识别、机器学习和神经科学等领域中也得到了
广泛的应用，用于特征选择、分类器设计等任务。 本研究中 ，微分熵 将被用于提取 特征。  
 
 支持向量机（ Support Vector Machine, SVM ）是一种强大的监督学习算法，广泛应用
于模式分类和回归分析等领域。其独特之处在于其优秀的泛化性能和对高维空间数据的处
理能力。 SVM 的基本目标是在特征空间中找到一个最优超平面，将不同类别的样本分隔开。
这个最优超平面被定义为能够使得两类样本之间的间隔最大化的超平面。支持向量机的名
字也来源于此，因为最优超平面的位置完全取决于一小部分样本点，它们被称为支持向量。
本研究中， SVM将被用分类 器。 
 
 SVM需求数据是经过归一化的。用 z-score scaling 对数据做归一化需要总体均值和方
差，这在训练过程中没有问题；但考虑测试场景：新数据依次传给模型，模型并不能一开
始就知道新数据的总体分布。  Ogasawara  和Martinez （2010）提出了 Adaptive feature 
normalization ，基于新数据对均值和方差进行实时更新，以适应新的数据。具体而言，初
始均值和方差定义为训练数据的均值和方差。随着新数据进入，均值或方差被更新为初始
值和新均值或方差的加权和，其中原均值和方差的权重随着新数据的输入呈指数衰减，衰
减率尝试性地设为  0.99。 
 
 
二 、技术路线  
1.数据集  
本工作使用 FACED数据集（Chen  et al, 2023）。改数据集记录了一个基于视频的情绪
认知实验的数据，包括脑电等。 
实验过程： 123个志愿者，以随机顺序观看 28个视频（视频时长 34-129秒不等，统
一截取后 30秒使用） 。这 28个视频中， 12个为积极情绪（ amusement, joy, inspiration, 
tenderness 各3个） ， 12个为消极情绪（ anger, disgust, fear, sadness 各3个） ，其余 4个
为中性情绪。  
数据规格：250hz，32通道脑电（实际上是 30通道，有两个是耳电极，不会用到） 。  
也就是说， raw data 结构是 123人*28视频*视频平均时长（秒） *250赫兹*30通道。  
 
2.特征工程  
2.1 微分熵  
 1）从数据集中加载 123个被试的数据，储存到一个数组中，这个数组有四个维度，
分别是被试数量，视频数量，通道数量，时间点数量 2）对delta，theta，alpha，beta，
gamma五个频带进行滤波 3）以一秒为时间窗和步长，对于所有片段计算方差 4）使用公
式计算 DE。 
 
2.2 adaptive feature normalization  
1）模拟 SVM中的 fold，基于每个 fold的训练集计算初始均值和方差。 2）对训练集
数据进行正常的 z-score scaling 3 ）对测试集数据做动态归一化 4）得到每个 fold的
normalized data 。 
 
3. 分类器：SVM 
1） 采用十折交叉，对于每一个折，决定 9/10的数据用于训练， 1/10的数据用于验证  
2）先使用被试内 分类，取在 128*28*sec 的每一项中取 9/10时长的训练集进行训练，
1/10时长的验证集用于测试模型的精确度。 3）再使用跨被试 分类，在 123个志愿者中
取9/10作为训练集进行训练， 1/10作为验证集用于测试模型的泛化性能。 4）用训练
集训练线性核 SVM分类器 5）评估其在训练集与测试集上的表现 。  
 
三 结果 & 讨论 
 
 fig.a         fig.b 
  
        intra，    intra，     cross，   cross，       intra，    intra，     cross，   cross， 
               train        val           train        val              train        val           train        val 
 图a 从左到右：三分类的准确率， 在被试内训练集、被试内测试集、跨被试训练集、
跨被试测试集。 图b 从左到右：九分类的准确率， 在被试内训练集、被试内测试集、跨被
试训练集、 跨被试测试集。 柱子高度代表均值，紫色线代表标准差。  
 
 在情绪三分类， 即消极、积极、中性分类中，每一组准确率都显著的高于 随机水平
0.33，且标准差 很低。训练集和验证集比较 ，准确率 没有显著的变化，说明没有过拟合的
现象。被式内和跨 被试相比，也没有显著不同，说明模型的泛化性也在三分类的任务中 很
优秀。在九分类中，每一组也都显著高于随机水平，说明 模型学到了很多的有效信息。 但
是在被试内和跨被试组相比，发现 跨被试的表现有所下降，说明用传统的线性核 svm模型
进行情绪的细分 仍然具有一定的局限性。 跨被试泛化性的问题是在情感计算领域一直被强
调的问题 ，因为不同人的情绪空间差异很大 ，将情绪体验外化为分数的策略也不同。在该
领域前沿，学者们提出了基于迁移学习，偏好学习，对比学习等各种的训练框架来应对这
一问题。 
  
 

 
 